Схемы "Звезда" и "Снежинка" (Star Schema и Snowflake Schema) — это два разных подхода к организации данных в хранилищах данных, которые используются для оптимизации запросов и структурирования аналитических данных. Основное различие между ними связано со степенью нормализации данных и сложностью структуры.

### 1. **Схема "Звезда"**
- **Структура:** Простая и плоская. Таблицы измерений напрямую связаны с таблицей фактов. Измерения денормализованы, что означает, что атрибуты измерений хранятся в одной таблице.
- **Нормализация:** Минимальная нормализация (или отсутствие нормализации). Измерительные таблицы часто содержат дублирующиеся данные.
- **Связи:** Связь между таблицей фактов и таблицами измерений осуществляется через один ключ (обычно первичный ключ в измерительной таблице и внешний ключ в таблице фактов).
- **Производительность:** Быстрая для чтения данных, так как запросы требуют меньшее количество соединений (JOINs).
- **Пример использования:** Эта схема предпочтительна, когда производительность запросов важнее экономии места, а данные не настолько сложны, чтобы требовалось их нормализовать. Например, анализ ежемесячных продаж по продуктам и регионам в розничной сети.

#### Пример:
- **Фактическая таблица:** Данные о продажах (продукт, дата, магазин, количество продаж, сумма).
- **Измерительные таблицы:** Продукты, Даты, Магазины. В каждой из этих таблиц содержатся все возможные атрибуты (например, в таблице продуктов: название продукта, категория, бренд и т.д.).

### 2. **Схема "Снежинка"**
- **Структура:** Более сложная и разветвленная. Измерительные таблицы нормализованы, и каждая таблица измерений может быть связана с другими измерениями.
- **Нормализация:** Высокая степень нормализации. Измерительные таблицы разбиваются на несколько таблиц в зависимости от их атрибутов. Это устраняет избыточность данных, но увеличивает сложность структуры.
- **Связи:** Связь между таблицей фактов и измерениями может осуществляться через несколько таблиц, которые связаны между собой через внешние ключи.
- **Производительность:** Производительность может страдать при выполнении сложных запросов из-за необходимости соединения (JOIN) нескольких таблиц. Но экономия места за счет устранения дублирующихся данных.
- **Пример использования:** Подходит для больших и сложных данных, где важна экономия дискового пространства и требуется поддержание целостности данных. Например, анализ международной логистической сети, где разные регионы имеют свои детализированные характеристики (страна, город, регион).

#### Пример:
- **Фактическая таблица:** Данные о продажах.
- **Измерительные таблицы:** Таблица продуктов нормализована и содержит связи с таблицами категорий и брендов. Таблица дат связана с таблицами "Год", "Месяц", "День".

### Основные отличия:

| Критерий             | **Схема "Звезда"**                        | **Схема "Снежинка"**                      |
|----------------------|--------------------------------------------|--------------------------------------------|
| **Структура**         | Простая и плоская                         | Разветвленная и нормализованная            |
| **Нормализация**      | Минимальная или отсутствие нормализации   | Высокая степень нормализации               |
| **Избыточность**      | Возможна избыточность данных              | Избыточность сведена к минимуму            |
| **Соединения (JOIN)** | Меньше соединений между таблицами         | Больше соединений                         |
| **Производительность**| Быстрее для чтения данных                 | Более медленное выполнение сложных запросов|
| **Экономия места**    | Использует больше пространства            | Экономия дискового пространства            |

### Когда выбрать каждую схему?

1. **Схема "Звезда"** предпочтительна:
   - Когда требуется быстрая обработка запросов.
   - Когда данные относительно просты, а избыточность данных не является проблемой.
   - Например, для отчетов о продажах или анализе маркетинговых кампаний в одной стране или регионе, где данные не требуют сложных взаимосвязей.

2. **Схема "Снежинка"** предпочтительна:
   - Когда важна экономия дискового пространства.
   - Когда данные сложные и многослойные, а нормализация помогает лучше управлять связями.
   - Например, для систем с международными или многопрофильными бизнес-процессами (логистика, управление запасами и т.д.), где каждая сущность может иметь несколько атрибутов и уровней иерархий.
