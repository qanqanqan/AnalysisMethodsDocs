

ZooKeeper предлагает гибкие методы аутентификации и авторизации, позволяя администраторам контролировать доступ к данным и обеспечивать безопасность распределенных систем. Использование таких методов, как Digest, SASL и mTLS, в сочетании с настройкой ACL, помогает защитить данные от несанкционированного доступа и манипуляций.

---
## Методы аутентификации

1. **Digest Authentication**:- Использует простую проверку подлинности с помощью паролей. Пароль хэшируется, и ZooKeeper хранит хэш для проверки.
    - Пример настройки:
```bash
export ZK_CLASSPATH=/etc/zookeeper/conf/:/usr/lib/zookeeper/* 
java -cp $ZK_CLASSPATH 
org.apache.zookeeper.server.auth.DigestAuthenticationProvider 
super:super123
```
    
2. **SASL Authentication**:- Поддерживает Kerberos для более безопасной аутентификации. SASL позволяет использовать различные механизмы аутентификации, такие как GSSAPI.
    - Для включения SASL необходимо добавить соответствующие настройки в файл конфигурации `zookeeper.properties`:
```text
authProvider.sasl=org.apache.zookeeper.server.auth.SASLAuthenticationProvider
```
    
3. **Mutual TLS (mTLS)**:
    
    - Обеспечивает аутентификацию на основе сертификатов, где как клиент, так и сервер должны предоставить действительные сертификаты.
    - Это повышает уровень безопасности, так как данные передаются по защищенному каналу.
---
## Методы авторизации

1. **ACL (Access Control Lists)**:- ZooKeeper использует списки управления доступом (ACL) для определения прав доступа к ZNode. ACL могут быть настроены для различных принципалов (пользователей или групп).
    - Пример установки ACL:
```bash
setAcl /myZnode world:anyone:r
```
    
2. **Типы ACL**:
    
    - **world**: Доступ для всех.
    - **auth**: Доступ для аутентифицированных пользователей.
    - **digest**: Доступ на основе пароля и имени пользователя.
    - **sasl**: Доступ на основе SASL-аутентификации.
    
3. **Super User**:
    
    - ZooKeeper может быть настроен для назначения суперпользователя, который имеет полные права на все ZNode. Это позволяет выполнять административные задачи, такие как изменение ACL или удаление узлов.
---

## Пример настройки

Для настройки аутентификации и авторизации в ZooKeeper необходимо выполнить следующие шаги:

1. **Настройка аутентификации**:  
    В файле `zookeeper.properties` добавьте:text
    
    `authProvider.x509=org.apache.zookeeper.server.auth.X509AuthenticationProvider authProvider.sasl=org.apache.zookeeper.server.auth.SASLAuthenticationProvider`
    
2. **Настройка ACL**:  
    Установите необходимые права доступа к ZNode с помощью команды `setAcl` в клиенте ZooKeeper.
3. **Перезапуск сервера**:  
    После внесения изменений перезапустите сервер ZooKeeper для применения новых настроек.
---

