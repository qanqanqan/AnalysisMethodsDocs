## Настройка ACL и квот в HDFS

Настройка Access Control Lists (ACL) и квот в Hadoop Distributed File System (HDFS) позволяет управлять доступом к данным и контролировать использование дискового пространства. Это важно для обеспечения безопасности данных и более эффективного управления ресурсами в кластере. Рассмотрим, как настроить ACL и квоты в HDFS.

### 1. Настройка ACL в HDFS

HDFS поддерживает ACL для управления доступом к файлам и каталогам на более детальном уровне, чем стандартные разрешения Unix (чтение, запись, выполнение).

#### a. Включение поддержки ACL

По умолчанию ACL могут быть включены в HDFS. Чтобы убедиться, что они активированы, проверьте файл `hdfs-site.xml` на наличие следующего параметра:

```xml
<property>
    <name>dfs.permissions.enabled</name>
    <value>true</value>
</property>
```

#### b. Задание ACL

Вы можете установить ACL с помощью команды `hadoop fs -setfacl`. Например, чтобы дать пользователю `user1` право чтения и записи на каталог `/data`, используйте следующую команду:

```bash
hadoop fs -setfacl -m user:user1:rw- /data
```

Здесь:

- `-m` указывает на изменение ACL.
- `user:user1:rw-` дает пользователю `user1` права чтения и записи.

Чтобы проверить текущие ACL для файла или каталога, выполните команду:

```bash
hadoop fs -getfacl /data
```

#### c. Удаление ACL

Для удаления ACL вы можете использовать команду `hadoop fs -setfacl` с параметром `-x`:

```bash
hadoop fs -setfacl -x user:user1 /data
```

### 2. Настройка квот в HDFS

Квоты позволяют контролировать объем дискового пространства, занимаемого пользователями или командами в HDFS. Это полезно для управления ресурсами и предотвращения ситуаций, когда один пользователь занимает все доступное пространство.

#### a. Установка квоты по количеству файлов (количество реплик)

Для установки квоты на количество файлов в каталоге вы можете использовать команду `hadoop fs -count`. Например:

```bash
hadoop fs -count -q /user/user1
```

Вы можете установить квоту на количество файлов с помощью следующей команды:

```bash
hadoop fs -setquota 1000 /user/user1
```

Эта команда устанавливает квоту на 1000 файлов для пользователя `user1`.

#### b. Установка квоты по использованию дискового пространства

Чтобы установить квоты по занимаемому пространству, вы можете использовать:

```bash
hadoop fs -setquota 10000 /user/user1
```

Эта команда устанавливает квоту на 10,000 блоков (обычно это приблизительно 10 MB в зависимости от размера блока в HDFS) для пользователя `user1`.

#### c. Проверка квот

Чтобы проверить текущие квоты, выполните команду:

```bash
hadoop fs -count -q /user/user1
```

#### d. Удаление квот

Если вам нужно удалить квоту, вы можете использовать команду `-removeQuota`:

```bash
hadoop fs -setquota 0 /user/user1
```

Это удалит все квоты для данного пользователя.