
Интеграция Hive с Tez значительно ускоряет выполнение запросов по сравнению с подходом MapReduce. 
Преимущества Tez: 
1. Улучшенная производительность 
2. Избежание ненужных операций записи 
3. Повторное использование контейнеров 
4. Гибкость и масштабируемость

Для активации Tez в Hive необходимо установить соответствующий параметр 
`SET hive.execution.engine=tez`. 

Параметры и настройки: 
`tez.grouping.min-size` - минимальный размер группировки разбиений. Уменьшение этого значения жет снизить задержки.
`tez.grouping.max-size` - максимальный размер группировки разбиений. Уменьшение этого значения может повысить производительность.

---
## Основные преимущества интеграции Hive с Tez

1. **Улучшенная производительность**: Tez обрабатывает задачи в виде направленных ациклических графов (DAG), что позволяет объединять несколько операций в одно задание. Это снижает накладные расходы на создание новых заданий и минимизирует задержки при выполнении запросов
2. **Избежание ненужных операций записи**: В отличие от MapReduce, где промежуточные данные записываются на диск, Tez использует минимальное количество заданий для обработки запросов. Это позволяет избежать лишних операций записи и улучшает общую производительность
3. **Повторное использование контейнеров**: Tez повторно использует контейнеры для выполнения задач, что снижает время на их инициализацию и уменьшает затраты на ресурсы
4. **Гибкость и масштабируемость**: Tez позволяет более гибко управлять ресурсами через YARN, что делает его подходящим для работы с разнообразными рабочими нагрузками и сценариями использования
---

## Настройка Hive для использования Tez
Для активации Tez в Hive необходимо установить соответствующий параметр:
``` sql
SET hive.execution.engine=tez;
```

---
## Конфигурация параметров Tez

Некоторые параметры конфигурации могут быть изменены для оптимизации работы Tez:

- **tez.grouping.min-size**: Минимальный размер группировки разбиений (по умолчанию 16 МБ). Уменьшение этого значения может снизить задержки.
- **tez.grouping.max-size**: Максимальный размер группировки разбиений (по умолчанию 1 ГБ). Уменьшение этого значения также может повысить производительность.

Пример настройки:
```sql
SET tez.grouping.min-size=1048576; -- 1 MB SET tez.grouping.max-size=67108864; -- 64 MB
```
---

## Использование формата хранения данных

Для максимальной эффективности рекомендуется использовать форматы хранения данных, такие как ORC или Parquet, которые обеспечивают высокую степень сжатия и оптимизацию чтения данных. Это дополнительно ускоряет выполнение запросов при использовании Tez.

Пример создания таблицы с использованием формата ORC:

``` sql
CREATE TABLE sales (     
	product_id INT,    
	amount DECIMAL(10,2) 
) STORED AS ORC;
```
---

