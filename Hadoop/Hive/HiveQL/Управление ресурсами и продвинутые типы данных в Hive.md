
Управление ресурсами и использование продвинутых типов данных в Apache Hive являются ключевыми аспектами для эффективной обработки больших объемов данных. Функция управления рабочими нагрузками позволяет оптимизировать распределение ресурсов в многопользовательских средах, а поддержка различных типов данных обеспечивает гибкость в работе с данными. Правильная настройка этих функций помогает значительно повысить производительность системы и улучшить качество аналитики.

---

## 1. Управление рабочими нагрузками (WLM)

Hive LLAP (Low Latency Analytical Processing) включает функцию управления рабочими нагрузками, которая позволяет разделять ресурсы между различными запросами и пользователями. Это особенно важно в многопользовательских средах, где конкуренция за ресурсы может влиять на производительность.

- **Пулы ресурсов**: WLM создает пулы ресурсов, которые можно настроить для конкретных рабочих нагрузок. Это позволяет выделять определенные проценты ресурсов для различных типов запросов (например, интерактивные запросы, ETL и т.д.).
- **Настройка очередей**: Создание и настройка очередей YARN позволяет управлять распределением ресурсов. Например, можно создать очередь `wm` с определенными параметрами:

|QueueName|Capacity|Max Capacity|Priority|Max AM Resource Size|
|---|---|---|---|---|
|default|5%|5%|0|33%|
|llap|85%|100%|10|33%|
|wm|10%|15%|9|100%|

- **Создание плана ресурсов**: Планы ресурсов позволяют управлять параллелизмом запросов и оптимизировать использование ресурсов.

## Пример создания плана ресурсов

```sql
SHOW RESOURCE PLANS;
```
Команды для создания и управления планами ресурсов могут включать:
```sql
CREATE RESOURCE PLAN demo_plan; 
ALTER RESOURCE PLAN demo_plan ENABLE; 
DROP RESOURCE PLAN demo_plan;
```

---
## 2. Продвинутые типы данных в Hive

Hive поддерживает различные продвинутые типы данных, что позволяет более гибко работать с данными.
## Структурированные данные

- **Структуры (STRUCT)**: Позволяют хранить записи с несколькими полями.

``` sql
CREATE TABLE employees (     
	id INT,    
	name STRING,    
	address STRUCT <street:STRING, city:STRING> 
);
```

- **Массивы (ARRAY)**: Позволяют хранить набор значений одного типа.

```sql
CREATE TABLE products (     
	id INT,    
	tags ARRAY<STRING> 
);
```

- **Карты (MAP)**: Хранят пары ключ-значение.

```sql
CREATE TABLE user_preferences (     
	user_id INT,    
	preferences MAP<STRING, STRING> 
	);
```

---

## Использование продвинутых типов данных

Эти типы данных позволяют выполнять более сложные запросы и манипуляции с данными. Например, можно использовать функции для работы с массивами и картами:

```sql
SELECT name, address.city FROM employees WHERE id = 1;
```


