
HiveQL - язык запросов, который используется в Apache Hive. Он основан на SQL, но не поддерживает весь функционал. HiveQL предназначен для работы с большими данными и преобразует запросы в задания MapReduce или Tez. 
Основные отличия: 
1. HiveQL не поддерживает операции Update, Delete для отдельных строк 
2. HiveQL не поддерживает типы данных даты и времени (рассматривает их как строки) 
3. HiveQL поддерживает сложные типы данных - массивы и структуры
4. Имеет ограниченные возможности JOIN
5. Отсутствует поддержка некоторых агрегатных функций
6. Нет поддержки оконных функций (например: `ROW_NUMBER()`, `RANK()`)

---

## Основные возможности HQL

- **Создание и управление базами данных и таблицами**: HQL позволяет создавать базы данных и таблицы, аналогично традиционным реляционным базам данных. Команды `CREATE DATABASE` и `CREATE TABLE` используются для этих целей.
- **Запросы к данным**: Основные операции включают выборку данных с помощью команды `SELECT`. Например, для получения всех записей из таблицы можно использовать:
```sql
SELECT * FROM имя_таблицы;
```
* **Для фильтрации данных** применяется оператор `WHERE`, что позволяет задавать условия для выборки.
- **Агрегация данных**: HQL поддерживает функции агрегации, такие как `COUNT`, `SUM`, `AVG`, что позволяет выполнять анализ данных на более высоком уровне.
- **Соединения и подзапросы**: HQL позволяет объединять данные из нескольких таблиц с помощью различных типов соединений (JOIN), таких как INNER JOIN и LEFT JOIN. Это дает возможность проводить сложные запросы и анализировать взаимосвязи между данными
- **Поддержка ACID-транзакций**: Hive поддерживает атомарные, согласованные, изолированные и долговечные транзакции, что позволяет безопасно обновлять данные с помощью команды `MERGE`.
---

## Примеры команд HQL

1. **Создание базы данных**:
```sql
    CREATE DATABASE IF NOT EXISTS mydatabase;
```
2. **Создание таблицы**:
``` sql    
    CREATE TABLE IF NOT EXISTS employees (     id INT,    name STRING,    age INT );
```
3. **Выборка данных с фильтрацией**:
``` sql
    SELECT * FROM employees WHERE age > 25;
```
4. **Агрегация данных**:
``` sql
    SELECT COUNT(*) FROM employees;
```
5. **Соединение таблиц**:
``` sql
    SELECT e.name, d.department_name  
      FROM employees e  
      JOIN departments d ON e.department_id = d.id;
```

---

## 1. Поддержка транзакций

HQL не поддерживает полноценные транзакции, как это делается в реляционных базах данных. Например, в SQL можно использовать команды `BEGIN`, `COMMIT` и `ROLLBACK` для управления транзакциями:

``` mysql
BEGIN; 
INSERT INTO users (name) VALUES ('Alice'); 
COMMIT;
```

В HQL такие команды отсутствуют, и изменения сразу применяются к данным без возможности откатить их.

## 2. Полноценные операции DML

HQL поддерживает только ограниченные операции вставки и обновления. Например, команда `INSERT INTO ... VALUES ...` не поддерживается. Вместо этого можно использовать только конструкцию `INSERT INTO ... SELECT ...`, что ограничивает гибкость:

``` sql
-- SQL 
INSERT INTO users (name) VALUES ('Alice'); 
-- HQL (не поддерживает такой синтаксис) 
INSERT INTO User (name) SELECT 'Alice';`
```

## 3. Ограниченные возможности JOIN

Хотя HQL поддерживает JOIN, его возможности могут быть ограничены по сравнению с SQL. Например, HQL не поддерживает сложные JOIN-операции с использованием подзапросов или объединения нескольких таблиц в одном запросе так же гибко, как это возможно в SQL.

``` sql
-- SQL 
SELECT u.name, o.order_date  
  FROM users u  
  JOIN orders o ON u.id = o.user_id  
 WHERE o.amount > 100; 
 -- HQL 
 SELECT u.name, o.orderDate  
   FROM User u 
   JOIN u.orders o  
  WHERE o.amount > 100; -- Ограниченные возможности по сравнению с SQL
```

## 4. Отсутствие поддержки некоторых агрегатных функций

HQL поддерживает базовые агрегатные функции, такие как `SUM`, `AVG`, `COUNT`, но не все функции доступны или могут быть использованы так же гибко, как в SQL. Например, функции для работы с временными рядами могут отсутствовать:

``` sql
-- SQL 
SELECT DATE_TRUNC('month', order_date), COUNT(*) 
  FROM orders 
 GROUP BY DATE_TRUNC('month', order_date); 
 -- HQL (не поддерживает DATE_TRUNC) 
 SELECT MONTH(o.orderDate), COUNT(*) 
   FROM Order o 
  GROUP BY MONTH(o.orderDate);
```

## 5. Нет поддержки оконных функций

Оконные функции, такие как `ROW_NUMBER()`, `RANK()`, и другие, которые широко используются в SQL для сложного анализа данных, отсутствуют в HQL:

```sql
-- SQL 
SELECT name, RANK() OVER (ORDER BY salary DESC) as rank 
  FROM employees; 
-- HQL (нет аналогов оконных функций) 
SELECT e.name  
  FROM Employee e 
 ORDER BY e.salary DESC; -- Без ранжирования
```

Эти ограничения делают HQL менее гибким для выполнения сложных аналитических задач по сравнению с традиционными реляционными базами данных.

---