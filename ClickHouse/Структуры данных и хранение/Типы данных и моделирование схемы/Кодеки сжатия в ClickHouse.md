В ClickHouse поддерживается множество кодеков сжатия, которые позволяют уменьшить объем хранимых данных и оптимизировать производительность вводов-выводов. Кодеки могут быть применены к колонкам таблиц для достижения более эффективного хранения данных. Вот основные аспекты, связанные с кодеками сжатия в ClickHouse:

### 1. Зачем нужны кодеки сжатия

- Снижение объема хранения: Кодеки позволяют уменьшить размер данных на диске, что может привести к уменьшению затрат на хранение.
- Улучшение производительности: Сжатые данные могут быть быстрее загружены в память, так как передаваемые по сети и считываемые с диска объемы меньше.
- Эффективность выборки: Некоторые кодеки оптимизированы для работы с конкретными типами данных, что позволяет ускорить выполнение запросов.

### 2. Основные кодеки сжатия

Вот некоторые из наиболее популярных кодеков сжатия, доступных в ClickHouse:

- LZ4: Высокоскоростной кодек сжатия, обеспечивающий хорошую компрессию и низкую задержку.
CODEC(LZ4)


- ZSTD: Кодек, предлагающий баланс между скоростью сжатия и коэффициентом сжатия, он может быть настроен на более агрессивное сжатие при большем времени обработки.
CODEC(ZSTD)


- LZPAGE: Оптимизирован для работы с колонками, содержащими большое количество повторяющихся значений.
CODEC(LZPAGE)


- Delta: Использует разность между значениями (подходит для числовых данных), что позволяет эффективно сжимать последовательные наборы. Часто используется в сочетании с другими кодеками.
CODEC(Delta)


- Run-length encoding (RLE): Эффективен для струн с последовательными одинаковыми значениями. Сжимает данные, представляя длинные последовательности одинаковых значений как короткие.
CODEC(RLE)


- Double Delta: Расширенная версия Delta, применяющая дельты к дельтам, может быть полезна для сильно сжатых данных.
CODEC(DoubleDelta)


- None: Отключение сжатия.
CODEC(None)


### 3. Применение кодеков при создании таблицы

Кодеки можно указать в момент создания таблицы для каждой колонки. Например:
```sql
CREATE TABLE example (
    id UInt64,
    value Float64 CODEC(ZSTD),
    description String CODEC(LZ4)
) ENGINE = MergeTree()
ORDER BY id;
```

### 4. Настройка и оптимизация кодеков

- Можно комбинировать кодеки для достижения наилучшей компрессии для конкретных типов данных. Например, можно использовать Delta для чисел, а RLE для строк.
- Определение кодеков можно также менять после создания таблицы с помощью команды ALTER TABLE. Например:
```sql
ALTER TABLE example MODIFY COLUMN value Float64 CODEC(ZSTD);
```

