Apache Kafka предоставляет три основные модели доставки сообщений: **at-most-once**, **at-least-once** и **exactly-once**. Каждая из этих моделей имеет свои характеристики и применимость в зависимости от требований к надежности и производительности.

## 1. At-Most-Once

- **Описание**: В этой модели сообщения могут быть доставлены один раз или не доставлены вовсе. Если происходит сбой, сообщения могут быть потеряны, и повторная доставка не осуществляется.
- **Применение**: Эта модель подходит для сценариев, где потеря сообщений допустима, например, в системах, где важнее высокая производительность и низкая задержка.
- **Настройка**: Для реализации at-most-once необходимо отключить повторные попытки отправки на стороне продюсера и настроить автоматическое подтверждение смещений на стороне потребителя до обработки сообщений.

## 2. At-Least-Once

- **Описание**: Гарантирует, что каждое сообщение будет доставлено как минимум один раз. Однако в случае сбоя одно и то же сообщение может быть доставлено несколько раз.
- **Применение**: Эта модель используется в системах, где критически важно получить каждое сообщение, даже если это приводит к дублированию.
- **Настройка**: Для обеспечения at-least-once продюсер должен ожидать подтверждения от брокера перед отправкой следующего сообщения. Потребитель должен подтверждать обработку сообщений только после их успешной обработки.

## 3. Exactly-Once

- **Описание**: Обеспечивает, что каждое сообщение будет доставлено ровно один раз. Это означает отсутствие потерь и дублирования сообщений даже в случае сбоев.
- **Применение**: Эта модель критически важна для приложений, обрабатывающих важные данные, такие как финансовые транзакции или медицинские записи.
- **Настройка**: Для реализации exactly-once необходимо использовать транзакционные продюсеры и включить управление изоляцией на стороне потребителей. Это позволяет гарантировать, что сообщения будут обработаны только после успешного завершения транзакции.

### Выбор модели доставки

Выбор подходящей модели доставки зависит от требований вашего приложения к надежности данных и производительности. Например:
- Если допустимы потери данных и важна скорость, можно использовать at-most-once.
- Если необходимо гарантировать получение всех сообщений без потерь, но с возможностью дублирования, стоит выбрать at-least-once.
- Если критически важно избежать дублирования при полной надежности, следует использовать exactly-once.

Эти модели помогают разработчикам адаптировать Apache Kafka под конкретные бизнес-требования и сценарии использования.
